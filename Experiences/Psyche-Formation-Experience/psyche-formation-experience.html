<head>
	<title>My A-Frame Scene</title>
	<script src="https://aframe.io/releases/1.3.0/aframe.min.js"></script>
	<!-- A-timeline scripts -->
	<script src="https://unpkg.com/aframe-animation-component@^4.1.1/dist/aframe-animation-timeline-component.min.js"></script> 
	<script src="https://unpkg.com/aframe-animation-timeline-component@1.6.0/dist/aframe-animation-timeline-component.min.js"></script>
	<!-- Particle scripts--> 
    <script src="https://cdn.jsdelivr.net/gh/c-frame/aframe-particle-system-component@master/dist/aframe-particle-system-component.min.js"></script> 
</head>

  <body>
	<a-scene animation-timeline__1="timeline: #myTimeline; loop: true">
		<a-assets timeout="10000">
		  <a-asset-item src="https://cdn.aframe.io/fonts/Roboto-msdf.json"></a-asset-item>

		  <a-timeline id="myTimeline">
			<!-- Intro text animation-->
			<a-timeline-animation select="#introText" name="togglevisible"></a-timeline-animation>
			<a-timeline-animation select="#introText" name="fadein"></a-timeline-animation>
			<a-timeline-animation select="#introText" name="fadeout"></a-timeline-animation>
			<a-timeline-animation select="#introText" name="togglevisibleoff"></a-timeline-animation>

			<!-- Planetesimal appearing animation -->
			<a-timeline-animation select="#Planetesimal" name="scale"></a-timeline-animation>

			<!-- Text about asteroid impact animation-->
			<a-timeline-animation select="#text1" name="togglevisible"></a-timeline-animation>
			<a-timeline-animation select="#text1" name="fadein"></a-timeline-animation>
			<a-timeline-animation select="#text1" name="threeseconddelay"></a-timeline-animation>
			<a-timeline-animation select="#text1" name="fadeout"></a-timeline-animation>
			<a-timeline-animation select="#text1" name="togglevisibleoff"></a-timeline-animation>
			
			<!-- Asteroid appearing animations -->
			<a-timeline-animation select="#Asteroid" name="scale"></a-timeline-animation>
			<a-timeline-animation select="#Asteroid" name="move_towards_planetesimal"></a-timeline-animation>
			
			<!-- Explosion and transformation into molten planetesimal animations-->
			<a-timeline-animation select="#Explosion" name="enable"></a-timeline-animation>
			<a-timeline-animation select="#Asteroid" name="bounce_off1"></a-timeline-animation>
			<a-timeline-animation select="#Planetesimal" name="togglevisibleoff"></a-timeline-animation>
			<a-timeline-animation select="#Molten" name="togglevisible"></a-timeline-animation>
			<a-timeline-animation select="#Asteroid" name="bounce_off2"></a-timeline-animation>	
			<a-timeline-animation select="#Asteroid" name="togglevisibleoff"></a-timeline-animation>

			<!-- Core hardening text animations-->
			<a-timeline-animation select="#text2" name="togglevisible"></a-timeline-animation>
			<a-timeline-animation select="#text2" name="fadein"></a-timeline-animation>
			<a-timeline-animation select="#text2" name="threeseconddelay"></a-timeline-animation>

			<!-- Core hardening animations -->
			<a-timeline-animation select="#Hardened" name="togglevisible"></a-timeline-animation>
			<a-timeline-animation select="#Molten" name="harden"></a-timeline-animation>
			<a-timeline-animation select="#text2" name="fadeout"></a-timeline-animation>
			<a-timeline-animation select="#text2" name="togglevisibleoff"></a-timeline-animation>

			<!-- Smaller asteroid impacts text animations-->
			<a-timeline-animation select="#text3" name="togglevisible"></a-timeline-animation>
			<a-timeline-animation select="#text3" name="fadein"></a-timeline-animation>

			<!-- Impacts of smaller rocks-->
			<a-timeline-animation select="#Debris1" name="move"></a-timeline-animation>
			<a-timeline-animation select="#Debris1" name="togglevisibleoff"></a-timeline-animation>
			<a-timeline-animation select="#Debris2" name="move"></a-timeline-animation>
			<a-timeline-animation select="#Debris2" name="togglevisibleoff"></a-timeline-animation>
			<a-timeline-animation select="#text3" name="fadeout"></a-timeline-animation>
			<a-timeline-animation select="#text3" name="togglevisibleoff"></a-timeline-animation>

			<!-- How psyche looks today text fade in-->
			<a-timeline-animation select="#text4" name="togglevisible"></a-timeline-animation>
			<a-timeline-animation select="#text4" name="fadein"></a-timeline-animation>

			<!-- Psyche -->
			<a-timeline-animation select="#Hardened" name="togglevisibleoff"></a-timeline-animation>
			<a-timeline-animation select="#Psyche" name="togglevisible"></a-timeline-animation>
			<a-timeline-animation select="#Psyche" name="delay"></a-timeline-animation>

			<!-- Text fade out-->
			<a-timeline-animation select="#text4" name="fadeout"></a-timeline-animation>
			<a-timeline-animation select="#text4" name="togglevisibleoff"></a-timeline-animation>
		  </a-timeline>

		  <!-- Stars Background-->
		  <img 
		  	id="skyTexture"
		  	src="./images/stars background.jpg">

		  <!-- Molten Planetesimal Texture-->	
		  <img 
		  	id="moltenMaterial" 
			src="./images/molten.png">

		  <!-- Hardened Planetesimal Texture-->	
		  <img 
		  	id="hardenedMaterial" 
			src="./images/asteroid.png">

		  <!-- Planetesimal -->
		  <a-asset-item
			  id="planetesimal-model"
			  src="../../models/gltf/planetesimal/scene.gltf">
		  </a-asset-item>
		
		  <!-- Asteroid -->
		  <a-asset-item
			id="asteroid-model"
			src="../../models/gltf/otherAsteroid/scene.gltf">
		  </a-asset-item>		  
		  
		  <!-- Psyche -->
		  <a-asset-item
		  	id="psyche-model"
		  	src="../../models/gltf/psycheAsteroid/psycheAlternate.gltf">
		  </a-asset-item>

		  <!-- Mixin with animations of all space objects -->
		  <a-mixin id="spaceRockMixin"
			animation__rotate="property: rotation; to: 0 360 0; easing: linear; dur: 50000; autoplay: true; loop: true"
			animation__togglevisible="property: visible; from: false; to: true; dur: 1; autoplay: false"
			animation__togglevisibleoff="property: visible; from: true; to: false; dur: 1; autoplay: false"
			animation__delay="property: visible; from: true; to: true; dur: 5000; autoplay: false">
		  </a-mixin>

		  <!-- Mixin for text animations -->
		  <a-mixin id="text"
			text="align: center; color: #FFF; width: 6; opacity: 0"
			animation__fadein="property: text.opacity; from: 0; to: 1; dur: 3000; easing: linear; autoplay: false"
			animation__threeseconddelay="property: visible; from: true; to: true; dur: 3000; autoplay: false"
			animation__fadeout="property: text.opacity; from: 1; to: 0; dur: 3000; easing: linear; autoplay: false"
			animation__togglevisible="property: visible; from: false; to: true; dur: 1; autoplay: false"
			animation__togglevisibleoff="property: visible; from: true; to: false; dur: 1; autoplay: false"
			position="0 3 -3"
			visible="false">
		  </a-mixin>
		</a-assets>
        
		<!-- Particle system -->
		<a-entity id="Explosion" 
			position="0 0 -7"
			animation__enable="property: particle-system.enabled; from: false; to: true; dur:1; autoplay: false"
			particle-system="enabled:false; texture: images/smokeparticle.png; particleCount:25000; color: #FF0000,#444400; velocityValue: 0 0 0; accelerationSpread: 0 0 0; accelerationValue: 0 0 0; maxAge: 2; duration:0.5">
		</a-entity>

		<!-- Background -->
		<a-sky src="#skyTexture"></a-sky>

		<!-- Texts -->
		<a-entity id="introText" mixin="text" text="value: How do scientists think Psyche formed?"></a-entity>
		<a-entity id="text1" mixin="text" text="value: One scenario is that long ago, a planetesimal that had separated internally into a rocky mantle and iron core suffered violent impacts that stripped away its mantle, leaving behind core material."></a-entity>
		<a-entity id="text2" mixin="text" text="value: The asteroid is most likely a survivor of multiple violent hit-and-run collisions, common when the solar system was forming. Thus Psyche may be able to tell us how Earth’s core and the cores of the other terrestrial planets came to be."></a-entity>
		<a-entity id="text3" mixin="text" text="value: As smaller objects continued to impact Psyche, they could leave craters on the surface."></a-entity>
		<a-entity id="text4" mixin="text" text="value: And this is an artist’s concept of how Psyche may looks today."></a-entity>

		<!-- Planetesimal -->
		<a-gltf-model
			id="Planetesimal" 
			mixin="spaceRockMixin"
			src="#planetesimal-model"
			position="0 0 -10"
			rotation="0 0 0"
			scale="0 0 0"
			animation__scale="property: scale; to: 0.005 0.005 0.005; dur: 2000; easing: easeInOutElastic; autoplay: false">
		</a-gltf-model>

		<!-- Other Asteroid -->
		<a-gltf-model 
			id="Asteroid" 
			mixin="spaceRockMixin"
			src="#asteroid-model"
			position="5 0 -1"
			rotation="0 0 0"
			scale="0 0 0"
			animation__rotate="property: rotation; to: 0 360 0; autoplay: true; loop: true; dur: 10000"
			animation__scale="property: scale; to: 0.01 0.01 0.01; dur: 2000; easing: easeInOutElastic; autoplay: false"
			animation__move_towards_planetesimal="property: position; to: 2 0 -7; easing:linear; autoplay:false; dur: 1875"
			animation__bounce_off1="property: position; from: 2 0 -7; to: 1.73 2.67 -7.53; easing:linear; autoplay:false; dur: 500"
			animation__bounce_off2="property: position; from: 1.73 2.67 -7.53; to: 0 20 -11; easing:linear; autoplay:false; dur: 3250">
		</a-gltf-model>

		<!-- Molten Planetesimal-->
        <a-entity 
            id="Molten"
			mixin="spaceRockMixin"
            position="0 0 -10" 
            geometry="primitive: sphere" 
            material="src: #moltenMaterial; opacity: 1;"
            scale="2 2 2"
			visible="false"
			animation__harden="property: material.opacity; from: 1; to: 0; dur: 3000; easing: linear; autoplay: false">
        </a-entity>
        
		<!-- Hardened Planetesimal-->
        <a-entity 
            id="Hardened"
			mixin="spaceRockMixin"
            position="0 0 -10" 
            geometry="primitive: sphere" 
            material="src: #hardenedMaterial; opacity: 1;"
            scale="2 2 2"
			visible="false">
        </a-entity>

		<!-- Debris 1-->
		<a-gltf-model 
			id="Debris1" 
			mixin="spaceRockMixin"
			src="#asteroid-model"
			position="1.85 0 1"
			rotation="0 0 0"
			visible="true"
			animation__move="property: position; to: 0 0 -10; easing:linear; autoplay:false; dur: 2000"
			scale="0.001 0.001 0.001">
		</a-gltf-model>		
		
		<!-- Debris 2-->
		<a-gltf-model 
			id="Debris2" 
			mixin="spaceRockMixin"
			src="#asteroid-model"
			position="-1.85 0 1"
			rotation="0 0 0"
			visible="true"
			animation__move="property: position; to: 0 0 -10; easing:linear; autoplay:false; dur: 2000"
			scale="0.001 0.001 0.001">
		</a-gltf-model>

		<!-- Psyche -->
		<a-gltf-model
			id="Psyche" 
			mixin="spaceRockMixin"
			src="#psyche-model"
			position="0 0 -10"
			rotation="0 0 0"
			scale="1 1 1"
			visible="false">
		</a-gltf-model>
	</a-scene>
  </body>
