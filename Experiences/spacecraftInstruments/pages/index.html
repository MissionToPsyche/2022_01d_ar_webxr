<!DOCTYPE html>
<html>
<head>
	<script src="https://aframe.io/releases/1.3.0/aframe.min.js"></script>
	<script>
		const boxDefaults = {scale:{x:1, y:1, z:1}, rotation:"0 45 0", enlarged:false, animating:false};
		let boxes = [
			boxDefaults, boxDefaults
		];
		AFRAME.registerComponent('separate-event', {
			init: function () {
				var el = this.el; // spacecraft
				el.addEventListener('click', function () {
					if (el.hasAttribute('separate-event')) {
						// remove the event from spacecraft
						el.removeAttribute('separate-event');

						// stop spacecraft rotation
						el.setAttribute('animation', "property: rotation; to: 0 0 0; loop: false; dur: 0");
						// lower spacecraft opacity
						el.setAttribute('material', "opacity: 0.3; transparent: true");
						// shrink spacecraft
						el.setAttribute('scale', "1.5 1.5 1.5");
						// make instruments visible
						var newEl = document.createElement('a-box');
						newEl.setAttribute('position', {x:0,y:1,z:-7.5});
						newEl.setAttribute('rotation', '0 0 0');
						newEl.setAttribute('scale', '0 0 0');
						newEl.setAttribute('color', 'blue');
						newEl.setAttribute('animation', 'property: position; to: -3 4 -7.5; loop: false; dur: 300; easing: linear');
						newEl.setAttribute('animation__2', 'property: scale; to: 2 2 2; loop: false; dur: 300; easing: linear');
						document.querySelector('a-scene').appendChild(newEl);
						var componentText = document.createElement('a-text');
						componentText.setAttribute('value','Multispectral Imager');
						componentText.setAttribute('position',{x:-3, y:3, z:-4.5});
						document.querySelector('a-scene').appendChild(componentText);

						var newEl = document.createElement('a-box');
						newEl.setAttribute('position', {x:0,y:1,z:-7.5});
						newEl.setAttribute('rotation', '0 0 0');
						newEl.setAttribute('scale', '0 0 0');
						newEl.setAttribute('color', 'red');
						newEl.setAttribute('animation', 'property: position; to: 3 4 -7.5; loop: false; dur: 300; easing: linear');
						newEl.setAttribute('animation__2', 'property: scale; to: 2 2 2; loop: false; dur: 300; easing: linear');
						document.querySelector('a-scene').appendChild(newEl);
						var componentText = document.createElement('a-text');
						componentText.setAttribute('value','Gamma Ray and\nNeutron Spectrometer');
						componentText.setAttribute('position',{x:1.5, y:3, z:-4.5});
						document.querySelector('a-scene').appendChild(componentText);

						var newEl = document.createElement('a-box');
						newEl.setAttribute('position', {x:0,y:1,z:-7.5});
						newEl.setAttribute('rotation', '0 0 0');
						newEl.setAttribute('scale', '0 0 0');
						newEl.setAttribute('color', 'green');
						newEl.setAttribute('animation', 'property: position; to: 3 -2 -7.5; loop: false; dur: 300; easing: linear');
						newEl.setAttribute('animation__2', 'property: scale; to: 2 2 2; loop: false; dur: 300; easing: linear');
						document.querySelector('a-scene').appendChild(newEl);
						var componentText = document.createElement('a-text');
						componentText.setAttribute('value','Magnetometer');
						componentText.setAttribute('position',{x:1.5, y:-1, z:-4.5});
						document.querySelector('a-scene').appendChild(componentText);

						var newEl = document.createElement('a-box');
						newEl.setAttribute('position', {x:0,y:1,z:-7.5});
						newEl.setAttribute('rotation', '0 0 0');
						newEl.setAttribute('scale', '0 0 0');
						newEl.setAttribute('color', 'yellow');
						newEl.setAttribute('animation', 'property: position; to: -3 -2 -7.5; loop: false; dur: 300; easing: linear');
						newEl.setAttribute('animation__2', 'property: scale; to: 2 2 2; loop: false; dur: 300; easing: linear');
						document.querySelector('a-scene').appendChild(newEl);
						var componentText = document.createElement('a-text');
						componentText.setAttribute('value','X-band Radio\nTelecommunications');
						componentText.setAttribute('position',{x:-3, y:-1, z:-4.5});
						document.querySelector('a-scene').appendChild(componentText);
					}
				});
			}
			
		});
	</script>
</head>

<body>
	<a-scene>
		<!-- spacecraft -->
		<a-box class="spacecraft" position="0 1 -7.5" scale="2 2 2" rotation="0 0 0" color="gray"
		animation="property: rotation; to: 0 90 0; easing: linear; loop: true; dur: 1000"
		material="src: ../../../src/img/spacecraft.png; color: #696969; roughness: 1; metalness: 0"
		separate-event></a-box>
		<!-- components -->
		<a-box class="component" id="multi" position="0 1 -7.5" scale="0 0 0" rotation="0 0 0" color="blue" component-select></a-box>
		<a-box class="component" id="gamma" position="0 1 -7.5" scale="0 0 0" rotation="0 0 0" color="red" component-select></a-box>
		<a-box class="component" id="magnet" position="0 1 -7.5" scale="0 0 0" rotation="0 0 0" color="green" component-select></a-box>
		<a-box class="component" id="xband" position="0 1 -7.5" scale="0 0 0" rotation="0 0 0" color="yellow" component-select></a-box>
		<!-- component text -->
		<a-text class="componentText" id="multiText" value="Multispectral Imager"></a-text>
		<a-text class="componentText" id="gammaText" value="Gamma Ray and\nNeutron Spectrometer"></a-text>
		<a-text class="componentText" id="magnetText" value="Magnetometer"></a-text>
		<a-text class="componentText" id="xbandText" value="X-band Radio\nTelecommunications"></a-text>

		<a-camera><a-cursor></a-cursor></a-camera>
	</a-scene>
</body>

</html>